result <- foo(5, 0)
print(result)
is.infinite(result)
library(adegenet)
# Isto kot na prejšnjih vajah zaženite ukaze, da naložite potrebne pakete (adegenet in dartR)
library(dartR)
install.packages("cli")
install.packages("cli")
install.packages("cli")
# Isto kot na prejšnjih vajah zaženite ukaze, da naložite potrebne pakete (adegenet in dartR)
library(dartR)
getwd()
load("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/2_exercises_R/funk_genomika.RData")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/slike_za_seminar/EP_za_sample.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/2_exercises_R/grafi/vsd.png")
knitr::include_graphics("C:\Users\scej4\OneDrive\Desktop\UNI_3B\Funk_genomika\2_exercises_R\grafi\MDS.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/2_exercises_R/grafi/MDS.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/3_exercises_R/grafi3/heat_map.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/slike_za_seminar/000010.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/slike_za_seminar/000012.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/slike_za_seminar/000016.png")
res2 <- results(dds, name = "cell.line.ch1_HMEC.1_vs_EA.hy926")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/heatMap_4Vaje.png")
View(res)
View(res.df.ordered)
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/slike_za_seminar/5_genes_log2FC.png")
setwd("C:/Users/scej4/OneDrive/Desktop/diplomska_koda/cbdasB_tfBindingSite_wholeGene")
library(tidyverse)
plus_strand <- function(x) {
read.table(file = x, sep = "\t") |>
filter(V6 == '+')
}
minus_strand <- function(x) {
read.table(file = x, sep = "\t") |>
filter(V6 == '-')
}
abacus_tfb <- plus_strand('abacus_cbdasB_tfb.txt')
finola_tfb <- plus_strand('finola_cbdasB_tfb.txt')
JL5_tfb <- plus_strand('JL5_cbdasB_tfb.txt')
JLdash_tfb <- plus_strand('JLdash_cbdasB_tfb.txt')
Pbanana_tfb <- plus_strand('Pbanana_cbdasB_tfb.txt')
PK_tfb <- plus_strand('PK_cbdasB_tfb.txt')
SL2_tfb <- plus_strand('SL2_cbdasB_tfb.txt')
anc1_tfb <- minus_strand('anc1_cbdasB_tfb.txt')
anc2_tfb <- minus_strand('anc2_cbdasB_tfb.txt')
cannatonic_tfb <- minus_strand('cannatonic_cbdasB_tfb.txt')
cannbio_tfb <- minus_strand('cannbio2_cbdasB_tfb.txt')
CP_tfb <- minus_strand('CP_cbdasB_tfb.txt')
hOG1_tfb <- minus_strand('hOG1_cbdasB_tfb.txt')
hOG2_tfb <- minus_strand('hOG2_cbdasB_tfb.txt')
JL_tfb <- minus_strand('JL_cbdasB_tfb.txt')
JLfather_tfb <- minus_strand('JLfather_cbdasB_tfb.txt')
JLmother_tfb <- minus_strand('JLmother_cbdasB_tfb.txt')
PR_tfb <- minus_strand('PR_cbdasB_tfb.txt')
SL1_tfb <- minus_strand('SL1_cbdasB_tfb.txt')
travisCBD1_tfb <- minus_strand('travisCBD1_cbdasB_tfb.txt')
travisCBD2_tfb <- minus_strand('travisCBD2_cbdasB_tfb.txt')
pPepper_tfb <- minus_strand('pPepper_cbdasB_tfb.txt')
plus_tfb_family_matrix <-
bind_rows(
abacus_tfb %>% mutate(Cultivar = "abacus"),
SL2_tfb %>% mutate(Cultivar = "SL2"),
finola_tfb %>% mutate(Cultivar = "finola"),
PK_tfb %>% mutate(Cultivar = "PKush"),
JLdash_tfb %>% mutate(Cultivar = "JLdash"),
JL5_tfb %>% mutate(Cultivar = "JL5"),
Pbanana_tfb %>% mutate(Cultivar = "Pbanana")) %>%
distinct(Cultivar, V1, V2) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Cultivar, values_from = value, values_fill = 0) %>%
add_column(WholeGene = 1) %>%
pivot_longer(cols = abacus:Pbanana, names_to = "Cultivar", values_to = "Presence")
View(plus_tfb_family_matrix)
View(abacus_tfb)
View(SL2_tfb)
ggplot(plus_tfb_family_matrix, aes(x = Cultivar, y = V1, fill = V2, alpha = Presence)) +
geom_tile(color = "white") +
scale_alpha_manual(values = c("0" = 0.1, "1" = 1)) +
scale_fill_brewer(palette = "Set3") +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Gene ID",
fill = "Family",
alpha = "Presence"
) %>% ggsave("heatmap_plus_tfb_family_wG.png", plot = ., width = 10,
height = max(6, length(unique(minus_family_presence_wG$V2)) * 0.15),
dpi = 300, bg = "white")
ggplot(plus_tfb_family_matrix, aes(x = Cultivar, y = V1, fill = V2, alpha = Presence)) +
geom_tile(color = "white") +
scale_alpha_manual(values = c("0" = 0.1, "1" = 1)) +
scale_fill_brewer(palette = "Set3") +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Gene ID",
fill = "Family",
alpha = "Presence"
) %>% ggsave("heatmap_plus_tfb_family_wG.png", plot = ., width = 10,
height = max(6, length(unique(plus_tfb_family_matrix$V2)) * 0.15),
dpi = 300, bg = "white")
ggplot(plus_tfb_family_matrix, aes(x = Cultivar, y = V1, fill = V2, alpha = Presence)) +
geom_tile(color = "white") +
scale_alpha_manual(values = c("0" = 0.1, "1" = 1)) +
scale_fill_brewer(palette = "Set3") +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Gene ID",
fill = "Family",
alpha = "Presence"
)
ggplot(plus_tfb_family_matrix, aes(x = Cultivar, y = V1, fill = V2, alpha = Presence)) +
geom_tile(color = "white") +
scale_fill_brewer(palette = "Set3") +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Gene ID",
fill = "Family",
alpha = "Presence"
)
ggplot(plus_tfb_family_matrix, aes(x = Cultivar, y = V1, fill = V2, alpha = Presence)) +
geom_tile(color = "white") +
scale_fill_brewer(palette = "Set3") +
scale_alpha_manual(values = c("0" = 0.1, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Gene ID",
fill = "Family",
alpha = "Presence"
)
ggplot(plus_tfb_family_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_brewer(palette = "Set3") +
scale_alpha_manual(values = c("0" = 0.1, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Gene ID",
fill = "Family",
alpha = "Presence"
)
ggplot(plus_tfb_family_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_brewer(palette = "Set3") +
scale_alpha_manual(values = c("0" = 0.1, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Gene ID",
fill = "Family",
alpha = "Presence"
) %>% ggsave("heatmap_plus_tfb_family_wG.png", plot = ., width = 10,
height = max(6, length(unique(plus_tfb_family_matrix$V2)) * 0.15),
dpi = 300, bg = "white")
ggplot(plus_tfb_family_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_brewer(palette = "Set3") +
scale_alpha_manual(values = c("0" = 0.1, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Gene ID",
fill = "Family",
alpha = "Presence"
)
ggplot(plus_tfb_family_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_viridis_d(option = "plasma") +
scale_alpha_manual(values = c("0" = 0.1, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Gene ID",
fill = "Family",
alpha = "Presence"
)
ggplot(plus_tfb_family_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_viridis_d(option = "cividis") +
scale_alpha_manual(values = c("0" = 0.1, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Gene ID",
fill = "Family",
alpha = "Presence"
)
ggplot(plus_tfb_family_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_viridis_d(option = "cividis") +
scale_alpha_manual(values = c("0" = 0.1, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(angle = 45, size = 5),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Gene ID",
fill = "Family",
alpha = "Presence"
)
ggplot(plus_tfb_family_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_viridis_d(option = "cividis") +
scale_alpha_manual(values = c("0" = 0.1, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(angle = 45, size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Gene ID",
fill = "Family",
alpha = "Presence"
)
ggplot(plus_tfb_family_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_viridis_d(option = "cividis") +
scale_alpha_manual(values = c("0" = 0.1, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(angle = 45, size = 6,  hjust = 1),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Gene ID",
fill = "Family",
alpha = "Presence"
)
ggplot(plus_tfb_family_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_viridis_d(option = "cividis") +
scale_alpha_manual(values = c("0" = 0.1, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(angle = 45, size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Gene ID",
fill = "Family",
alpha = "Presence"
)
ggplot(plus_tfb_family_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_viridis_d(option = "cividis") +
scale_alpha_manual(values = c("0" = 0.1, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(angle = 45, size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Gene ID",
fill = "Family",
alpha = "Presence"
) %>% ggsave("heatmap_plus_tfb_family_wG.png", plot = ., width = 10,
height = max(6, length(unique(plus_tfb_family_matrix$V2)) * 0.15),
dpi = 300, bg = "white")
(
ggplot(plus_tfb_family_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_viridis_d(option = "cividis") +
scale_alpha_manual(values = c("0" = 0.1, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(angle = 45, size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Gene ID",
fill = "Family",
alpha = "Presence"
)
) %>% ggsave("heatmap_plus_tfb_family_wG.png", plot = ., width = 10,
height = max(6, length(unique(plus_tfb_family_matrix$V1)) * 0.15),
dpi = 300, bg = "white")
(
ggplot(plus_tfb_family_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_viridis_d(option = "turbo") +
scale_alpha_manual(values = c("0" = 0.1, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(angle = 45, size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Gene ID",
fill = "Family",
alpha = "Presence"
)
) %>% ggsave("heatmap_plus_tfb_family_wG.png", plot = ., width = 10,
height = max(6, length(unique(plus_tfb_family_matrix$V1)) * 0.15),
dpi = 300, bg = "white")
(
ggplot(plus_tfb_family_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_viridis_d(option = "turbo") +
scale_alpha_manual(values = c("0" = 0, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(angle = 45, size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Motif",
fill = "Family",
alpha = "Presence"
)
) %>% ggsave("heatmap_plus_tfb_family_wG.png", plot = ., width = 10,
height = max(6, length(unique(plus_tfb_family_matrix$V1)) * 0.15),
dpi = 300, bg = "white")
minus_tfb_family_matrix <-
bind_rows(
anc1_tfb %>% mutate(Cultivar = "anc1"),
anc2_tfb %>% mutate(Cultivar = "anc2"),
cannatonic_tfb %>% mutate(Cultivar = "cannatonic"),
cannbio_tfb %>% mutate(Cultivar = "cannbio"),
CP_tfb %>% mutate(Cultivar = "CP"),
hOG1_tfb %>% mutate(Cultivar = "hOG1"),
hOG2_tfb %>% mutate(Cultivar = "hOG2"),
JL_tfb %>% mutate(Cultivar = "JL"),
JLfather_tfb %>% mutate(Cultivar = "JLfather"),
JLmother_tfb %>% mutate(Cultivar = "JLmother"),
PR_tfb %>% mutate(Cultivar = "PR"),
SL1_tfb %>% mutate(Cultivar = "SL1"),
travisCBD1_tfb %>% mutate(Cultivar = "t1"),
travisCBD2_tfb %>% mutate(Cultivar = "t2"),
pPepper_tfb %>% mutate(Cultivar = "pPepper")) %>%
distinct(Cultivar, V1, V2) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Cultivar, values_from = value, values_fill = 0) %>%
add_column(WholeGene = 1) %>%
pivot_longer(cols = anc1:pPepper, names_to = "Cultivar", values_to = "Presence")
View(minus_tfb_family_matrix)
(
ggplot(minus_tfb_family_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_viridis_d(option = "turbo") +
scale_alpha_manual(values = c("0" = 0, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(angle = 45, size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Motif",
fill = "Family",
alpha = "Presence"
)
) %>% ggsave("heatmap_minus_tfb_family_wG.png", plot = ., width = 10,
height = max(6, length(unique(minus_tfb_family_matrix$V1)) * 0.15),
dpi = 300, bg = "white")
(
ggplot(plus_tfb_family_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_viridis_d(option = "turbo") +
scale_alpha_manual(values = c("0" = 0, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(angle = 45, size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Motif",
fill = "Family",
alpha = "Presence",
title = "Predicted TFB sites & families presence across different Cannabis S. cultivars (cbdas, whole gene) - plus st."
)
) %>% ggsave("heatmap_plus_tfb_family_wG.png", plot = ., width = 10,
height = max(6, length(unique(plus_tfb_family_matrix$V1)) * 0.15),
dpi = 300, bg = "white")
(
ggplot(plus_tfb_family_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_viridis_d(option = "turbo") +
scale_alpha_manual(values = c("0" = 0, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(angle = 45, size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Motif",
fill = "Family",
alpha = "Presence",
title = "Predicted TFB sites & families presence across different Cannabis S. cultivars (cbdas, whole gene+promotor) - plus strand"
)
) %>% ggsave("heatmap_plus_tfb_family_wG.png", plot = ., width = 10,
height = max(6, length(unique(plus_tfb_family_matrix$V1)) * 0.15),
dpi = 300, bg = "white")
(
ggplot(minus_tfb_family_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_viridis_d(option = "turbo") +
scale_alpha_manual(values = c("0" = 0, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(angle = 45, size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Motif",
fill = "Family",
alpha = "Presence",
title = "Predicted TFB sites & families presence across different Cannabis S. cultivars (cbdas, whole gene+promotor) - minus strand"
)
) %>% ggsave("heatmap_minus_tfb_family_wG.png", plot = ., width = 10,
height = max(6, length(unique(minus_tfb_family_matrix$V1)) * 0.15),
dpi = 300, bg = "white")
View(plus_tfb_family_matrix)
plus_tfb_family_matrix %>% group_by(.$V2) %>% count(.) %>% head()
plus_families_count <- plus_tfb_family_matrix %>% group_by(.$V2) %>% count(.)
View(plus_families_count)
minus_families_count <- minus_tfb_family_matrix %>% group_by(.$V2) %>% count(.)
View(minus_families_count)
View(minus_tfb_family_matrix)

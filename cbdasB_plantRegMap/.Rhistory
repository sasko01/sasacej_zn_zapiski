trees %>%
max(.$Volume) %>%
select(Girth, Height, Volume)
trees %>%
max(.$Volume)
trees %>%
.[order(.$Volume, decreasing = T), ] %>%
.[1, ]
trees %>%
ggplot(aes(Height, Volume)) +
geom_point()
trees %>%
ggplot(aes(Height, Volume)) +
geom_jitter()
data("trees")
trees %>%
mean(Height)
trees %>%
summarise(Mean_height = mean(Height))
trees$Size <- as.factor(trees$Volume < 20, 'Majhno', trees$Volume >= 40, 'Veliko', 'Srednje')
trees$Size <- as.factor(
ifelse(trees$Volume < 20, 'Majhno',
ifelse(trees$Volume >= 20 && trees$Volume < 40, 'Srednje',
ifelse(trees$Volume >= 40, 'Veliko')))
)
trees$Size <- as.factor(
ifelse(trees$Volume < 20, 'Majhno',
ifelse(trees$Volume >= 20 && trees$Volume < 40, 'Srednje', 'Veliko'))
)
trees$Size <- as.factor(
ifelse(trees$Volume < 20, 'Majhno',
ifelse(trees$Volume >= 40, 'Veliko', 'Srednje'))
)
head(trees)
trees %>%
group_by(Size) %>%
summarise(stevilo = n())
trees %>%
group_by(Size) %>%
summarise(stevilo = n()) %>%
ggplot(aes(Size, stevilo)) +
geom_col()
foo <- function(x, y) {
if (x == 0) {
return(y)
} else {
y <- 2 * y + x %% 2
return(foo(x / 2, y))
}
}
result <- foo(5, 0)
print(result)
is.infinite(result)
library(adegenet)
# Isto kot na prejšnjih vajah zaženite ukaze, da naložite potrebne pakete (adegenet in dartR)
library(dartR)
install.packages("cli")
install.packages("cli")
install.packages("cli")
# Isto kot na prejšnjih vajah zaženite ukaze, da naložite potrebne pakete (adegenet in dartR)
library(dartR)
getwd()
load("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/2_exercises_R/funk_genomika.RData")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/slike_za_seminar/EP_za_sample.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/2_exercises_R/grafi/vsd.png")
knitr::include_graphics("C:\Users\scej4\OneDrive\Desktop\UNI_3B\Funk_genomika\2_exercises_R\grafi\MDS.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/2_exercises_R/grafi/MDS.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/3_exercises_R/grafi3/heat_map.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/slike_za_seminar/000010.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/slike_za_seminar/000012.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/slike_za_seminar/000016.png")
res2 <- results(dds, name = "cell.line.ch1_HMEC.1_vs_EA.hy926")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/heatMap_4Vaje.png")
View(res)
View(res.df.ordered)
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/slike_za_seminar/5_genes_log2FC.png")
setwd("C:/Users/scej4/OneDrive/Desktop/diplomska_koda/cbdasB_regulationPredicition")
library(tidyverse)
plus_strand2 <- function(x) {
read.table(file = x, sep = "\t") |>
filter(V5 == '+')
}
minus_strand2 <- function(x) {
read.table(file = x, sep = "\t") |>
filter(V5 == '-')
}
abacus_reg <- plus_strand2("abacus_cbdasB_reg.txt")
finola_reg <- plus_strand2("finola_cbdasB_reg.txt")
JL5_reg <- plus_strand2("JL5_cbdasB_reg.txt")
JLdash_reg <- plus_strand2("JLdash_cbdasB_reg.txt")
pBanana_reg <- plus_strand2("pBanana_cbdasB_reg.txt")
PK_reg <- plus_strand2("PK_cbdasB_reg.txt")
SL2_reg <- plus_strand2("SL2_cbdasB_reg.txt")
anc1_reg <- minus_strand2('anc1_cbdasB_reg.txt')
anc2_reg <- minus_strand2('anc2_cbdasB_reg.txt')
cannatonic_reg <- minus_strand2('cannatonic_cbdasB_reg.txt')
cannbio_reg <- minus_strand2('cannbio2_cbdasB_reg.txt')
CP_reg <- minus_strand2('CP_cbdasB_reg.txt')
hOG1_reg <- minus_strand2('hOG1_cbdasB_reg.txt')
hOG2_reg <- minus_strand2('hOG2_cbdasB_reg.txt')
JL_reg <- minus_strand2('JL_cbdasB_reg.txt')
JLfather_reg <- minus_strand2('JLfather_cbdasB_reg.txt')
JLmother_reg <- minus_strand2('JLmother_cbdasB_reg.txt')
PR_reg <- minus_strand2('PR_cbdasB_reg.txt')
SL1_reg <- minus_strand2('SL1_cbdasB_reg.txt')
travisCBD1_reg <- minus_strand2('travisCBD1_cbdasB_reg.txt')
travisCBD2_reg <- minus_strand2('travisCBD2_cbdasB_reg.txt')
pPepper_reg <- minus_strand2('pPepper_cbdasB_reg.txt')
View(pPepper_reg)
minus_reg_presence_matrix <-
bind_rows(
anc1_reg %>% mutate(Cultivar = "anc1"),
anc2_reg %>% mutate(Cultivar = "anc2"),
cannatonic_reg %>% mutate(Cultivar = "cannatonic"),
cannbio_reg %>% mutate(Cultivar = "cannbio"),
CP_reg %>% mutate(Cultivar = "CP"),
hOG1_reg %>% mutate(Cultivar = "hOG1"),
hOG2_reg %>% mutate(Cultivar = "hOG2"),
JL_reg %>% mutate(Cultivar = "JL"),
PR_reg %>% mutate(Cultivar = "PR"),
SL1_reg %>% mutate(Cultivar = "SL1"),
travisCBD1_reg %>% mutate(Cultivar = "t1"),
travisCBD2_reg %>% mutate(Cultivar = "t2"),
pPepper_reg %>% mutate(Cultivar = "pPepper")) %>%
distinct(Cultivar, V1) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Cultivar, values_from = value, values_fill = 0) %>%
pivot_longer(-V1, names_to = "Cultivar", values_to = "Present")
heatmap_minus_reg <-
ggplot(minus_reg_presence_matrix, aes(x = Cultivar, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present",
title = "Predicted Regulatory sites presence across different Cannabis S. cultivars (cbdas) - minus st.") +
theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 1.2),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggsave("heatmap_minus_reg.png", plot = heatmap_minus_reg, width = 8,
height = max(6, length(unique(minus_reg_presence_matrix$V1)) * 0.15),
dpi = 300, bg = "white")
minus_reg_presence_matrix <-
bind_rows(
anc1_reg %>% mutate(Cultivar = "anc1"),
anc2_reg %>% mutate(Cultivar = "anc2"),
cannatonic_reg %>% mutate(Cultivar = "cannatonic"),
cannbio_reg %>% mutate(Cultivar = "cannbio"),
CP_reg %>% mutate(Cultivar = "CP"),
hOG1_reg %>% mutate(Cultivar = "hOG1"),
hOG2_reg %>% mutate(Cultivar = "hOG2"),
JL_reg %>% mutate(Cultivar = "JL"),
JLfather_reg %>% mutate(Cultivar = "JLfather"),
JLmother_reg %>% mutate(Cultivar = "JLmother"),
PR_reg %>% mutate(Cultivar = "PR"),
SL1_reg %>% mutate(Cultivar = "SL1"),
travisCBD1_reg %>% mutate(Cultivar = "t1"),
travisCBD2_reg %>% mutate(Cultivar = "t2"),
pPepper_reg %>% mutate(Cultivar = "pPepper")) %>%
distinct(Cultivar, V1) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Cultivar, values_from = value, values_fill = 0) %>%
pivot_longer(-V1, names_to = "Cultivar", values_to = "Present")
heatmap_minus_reg <-
ggplot(minus_reg_presence_matrix, aes(x = Cultivar, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present",
title = "Predicted Regulatory sites presence across different Cannabis S. cultivars (cbdas) - minus st.") +
theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 1.2),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggsave("heatmap_minus_reg.png", plot = heatmap_minus_reg, width = 8,
height = max(6, length(unique(minus_reg_presence_matrix$V1)) * 0.15),
dpi = 300, bg = "white")
plus_reg_presence_matrix <-
bind_rows(
abacus_reg %>% mutate(Cultivar = "abacus"),
SL2_reg %>% mutate(Cultivar = "SL2"),
finola_reg %>% mutate(Cultivar = "finola"),
PK_reg %>% mutate(Cultivar = "PKush"),
JLdash_reg %>% mutate(Cultivar = "JLdash"),
JL5_reg %>% mutate(Cultivar = "JL5"),
pBanana_reg %>% mutate(Cultivar = "Pbanana")) %>%
distinct(Cultivar, V1) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Cultivar, values_from = value, values_fill = 0) %>%
pivot_longer(-V1, names_to = "Cultivar", values_to = "Present")
+theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 1.2),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggsave("heatmap_plus_reg.png", plot = heatmap_plus_reg, width = 8,
height = max(6, length(unique(plus_reg_presence_matrix$V1)) * 0.15),
dpi = 300, bg = "white")
+theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 1.2),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
heatmap_plus_reg <-
ggplot(plus_reg_presence_matrix, aes(x = Cultivar, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present",
title = "Predicted Regulatory sites presence across different Cannabis S. cultivars (cbdas) - plus st.") +
theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 1.2),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggsave("heatmap_plus_reg.png", plot = heatmap_plus_reg, width = 8,
height = max(6, length(unique(plus_reg_presence_matrix$V1)) * 0.15),
dpi = 300, bg = "white")
setwd("C:/Users/scej4/OneDrive/Desktop/diplomska_koda/cbdasB_tfBindingSite_wholeGene")
library(tidyverse)
plus_strand <- function(x) {
read.table(file = x, sep = "\t") |>
filter(V6 == '+')
}
minus_strand <- function(x) {
read.table(file = x, sep = "\t") |>
filter(V6 == '-')
}
abacus_tfb <- plus_strand('abacus_cbadsB_tfb.txt')
finola_tfb <- plus_strand('finola_cbdasB_tfb.txt')
JL5_tfb <- plus_strand('JL5_cbdasB_tfb.txt')
JLdash_tfb <- plus_strand('JLdash_cbdasB_tfb.txt')
View(JLdash_tfb)
Pbanana_tfb <- plus_strand('Pbanana_cbdasB_tfb.txt')
PKush_tfb <- plus_strand('PK_cbdasB_tfb.txt')
SL2_tfb <- plus_strand('SL2_cbdasB_tfb.txt')
anc1_tfb <- minus_strand('anc1_cbdasB_tfb.txt')
anc2_tfb <- minus_strand('anc2_cbdasB_tfb.txt')
cannatonic_tfb <- minus_strand('cannatonic_cbdasB_tfb.txt')
cannbio_tfb <- minus_strand('cannbio_cbdasB_tfb.txt')
cannbio_tfb <- minus_strand('cannbio2_cbdasB_tfb.txt')
CP_tfb <- minus_strand('CP_cbdasB_tfb.txt')
hOG1_tfb <- minus_strand('hOG1_cbdasB_tfb.txt')
hOG2_tfb <- minus_strand('hOG2_cbdasB_tfb.txt')
JL_tfb <- minus_strand('JL_cbdasB_tfb.txt')
JLfather_tfb <- minus_strand('JLfather_cbdasB_tfb.txt')
JLmother_tfb <- minus_strand('JLmother_cbdasB_tfb.txt')
PR_tfb <- minus_strand('PR_cbdasB_tfb.txt')
SL1_tfb <- minus_strand('SL1_cbdasB_tfb.txt')
travisCBD1_tfb <- minus_strand('travisCBD1_cbdasB_tfb.txt')
travisCBD2_tfb <- minus_strand('travisCBD2_cbdasB_tfb.txt')
pPepper_tfb <- minus_strand('pPepper_cbdasB_tfb.txt')
View(travisCBD2_tfb)
PK_tfb <- plus_strand('PK_cbdasB_tfb.txt')
plus_tfb_presence_matrix <-
bind_rows(
abacus_tfb %>% mutate(Cultivar = "abacus", WholeGene = 1),
SL2_tfb %>% mutate(Cultivar = "SL2", WholeGene = 1),
finola_tfb %>% mutate(Cultivar = "finola", WholeGene = 1),
PK_tfb %>% mutate(Cultivar = "PKush", WholeGene = 1),
JLdash_tfb %>% mutate(Cultivar = "JLdash", WholeGene = 1),
JL5_tfb %>% mutate(Cultivar = "JL5", WholeGene = 1),
Pbanana_tfb %>% mutate(Cultivar = "Pbanana", WholeGene = 1)) %>%
distinct(Cultivar, V1) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Cultivar, values_from = value, values_fill = 0) %>%
pivot_longer(-V1, names_to = "Cultivar", values_to = "Present")
abacus_tfb <- plus_strand('abacus_cbadsB_tfb.txt')
abacus_tfb <- plus_strand('abacus_cbdasB_tfb.txt')
plus_tfb_presence_matrix <-
bind_rows(
abacus_tfb %>% mutate(Cultivar = "abacus", WholeGene = 1),
SL2_tfb %>% mutate(Cultivar = "SL2", WholeGene = 1),
finola_tfb %>% mutate(Cultivar = "finola", WholeGene = 1),
PK_tfb %>% mutate(Cultivar = "PKush", WholeGene = 1),
JLdash_tfb %>% mutate(Cultivar = "JLdash", WholeGene = 1),
JL5_tfb %>% mutate(Cultivar = "JL5", WholeGene = 1),
Pbanana_tfb %>% mutate(Cultivar = "Pbanana", WholeGene = 1)) %>%
distinct(Cultivar, V1) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Cultivar, values_from = value, values_fill = 0) %>%
pivot_longer(-V1, names_to = "Cultivar", values_to = "Present")
View(plus_tfb_presence_matrix)
View(plus_tfb_presence_matrix)
View(abacus_tfb)
plus_tfb_presence_matrix <-
bind_rows(
abacus_tfb %>% mutate(Cultivar = "abacus"),
SL2_tfb %>% mutate(Cultivar = "SL2"),
finola_tfb %>% mutate(Cultivar = "finola"),
PK_tfb %>% mutate(Cultivar = "PKush"),
JLdash_tfb %>% mutate(Cultivar = "JLdash"),
JL5_tfb %>% mutate(Cultivar = "JL5"),
Pbanana_tfb %>% mutate(Cultivar = "Pbanana")) %>%
mutate(WholeGene = 1) %>%
distinct(Cultivar, V1) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Cultivar, values_from = value, values_fill = 0) %>%
pivot_longer(-V1, names_to = "Cultivar", values_to = "Present")
View(plus_tfb_presence_matrix)
plus_tfb_presence_matrix2 <-
bind_rows(
abacus_tfb %>% mutate(Cultivar = "abacus"),
SL2_tfb %>% mutate(Cultivar = "SL2"),
finola_tfb %>% mutate(Cultivar = "finola"),
PK_tfb %>% mutate(Cultivar = "PKush"),
JLdash_tfb %>% mutate(Cultivar = "JLdash"),
JL5_tfb %>% mutate(Cultivar = "JL5"),
Pbanana_tfb %>% mutate(Cultivar = "Pbanana")) %>%
mutate(WholeGene = 1) %>%
distinct(Cultivar, V1) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Cultivar, values_from = value, values_fill = 0) %>%
pivot_longer(-V1, names_to = "Cultivar", values_to = "Present")
View(plus_tfb_presence_matrix2)
heatmap_plus_tfb <-
ggplot(plus_tfb_presence_matrix, aes(x = Cultivar, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present",
title = "Predicted TF binding sites presence across different Cannabis S. cultivars (cbdas, whole gene) - plus st.") +
theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 1.2),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggsave("heatmap_plus_tfb.png", plot = heatmap_plus_tfb, width = 8,
height = max(6, length(unique(plus_tfb_presence_matrix$V1)) * 0.15),
dpi = 300, bg = "white")
ggsave("heatmap_plus_tfb.png", plot = heatmap_plus_tfb, width = 10,
height = max(6, length(unique(plus_tfb_presence_matrix$V1)) * 0.15),
dpi = 300, bg = "white")
plus_tfb_presence_matrix <-
bind_rows(
abacus_tfb %>% mutate(Cultivar = "abacus"),
SL2_tfb %>% mutate(Cultivar = "SL2"),
finola_tfb %>% mutate(Cultivar = "finola"),
PK_tfb %>% mutate(Cultivar = "PKush"),
JLdash_tfb %>% mutate(Cultivar = "JLdash"),
JL5_tfb %>% mutate(Cultivar = "JL5"),
Pbanana_tfb %>% mutate(Cultivar = "Pbanana")) %>%
mutate(WholeGene = 1) %>%
distinct(Cultivar, V1, WholeGene) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Cultivar, values_from = value, values_fill = 0) %>%
pivot_longer(-V1, names_to = "Cultivar", values_to = "Present")
View(plus_tfb_presence_matrix)
minus_tfb_presence_matrix <-
bind_rows(
anc1_tfb %>% mutate(Cultivar = "anc1"),
anc2_tfb %>% mutate(Cultivar = "anc2"),
cannatonic_tfb %>% mutate(Cultivar = "cannatonic"),
cannbio_tfb %>% mutate(Cultivar = "cannbio"),
CP_tfb %>% mutate(Cultivar = "CP"),
hOG1_tfb %>% mutate(Cultivar = "hOG1"),
hOG2_tfb %>% mutate(Cultivar = "hOG2"),
JL_tfb %>% mutate(Cultivar = "JL"),
JLfather_tfb %>% mutate(Cultivar = "JLfather"),
JLmother_tfb %>% mutate(Cultivar = "JLmother"),
PR_tfb %>% mutate(Cultivar = "PR"),
SL1_tfb %>% mutate(Cultivar = "SL1"),
travisCBD1_tfb %>% mutate(Cultivar = "t1"),
travisCBD2_tfb %>% mutate(Cultivar = "t2"),
pPepper_tfb %>% mutate(Cultivar = "pPepper")) %>%
distinct(Cultivar, V1) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Cultivar, values_from = value, values_fill = 0) %>%
pivot_longer(-V1, names_to = "Cultivar", values_to = "Present")
View(minus_tfb_presence_matrix)
heatmap_minus_tfb <-
ggplot(minus_tfb_presence_matrix, aes(x = Cultivar, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present",
title = "Predicted TF binding sites presence across different Cannabis S. cultivars (cbdas, whole gene) - minus st.") +
theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 1.2),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggsave("heatmap_minus_tfb.png", plot = heatmap_minus_tfb, width = 10,
height = max(6, length(unique(minus_tfb_presence_matrix$V1)) * 0.15),
dpi = 300, bg = "white")
minus_tfb_presence_matrix <-
bind_rows(
anc1_tfb %>% mutate(Cultivar = "anc1"),
anc2_tfb %>% mutate(Cultivar = "anc2"),
cannatonic_tfb %>% mutate(Cultivar = "cannatonic"),
cannbio_tfb %>% mutate(Cultivar = "cannbio"),
CP_tfb %>% mutate(Cultivar = "CP"),
hOG1_tfb %>% mutate(Cultivar = "hOG1"),
hOG2_tfb %>% mutate(Cultivar = "hOG2"),
JL_tfb %>% mutate(Cultivar = "JL"),
JLfather_tfb %>% mutate(Cultivar = "JLfather"),
JLmother_tfb %>% mutate(Cultivar = "JLmother"),
PR_tfb %>% mutate(Cultivar = "PR"),
SL1_tfb %>% mutate(Cultivar = "SL1"),
travisCBD1_tfb %>% mutate(Cultivar = "t1"),
travisCBD2_tfb %>% mutate(Cultivar = "t2"),
pPepper_tfb %>% mutate(Cultivar = "pPepper")) %>%
distinct(Cultivar, V1) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Cultivar, values_from = value, values_fill = 0) %>%
pivot_longer(-V1, names_to = "Cultivar", values_to = "Present") %>%
add_column(WholeGene = 1)
View(minus_tfb_presence_matrix)
plus_tfb_presence_matrix <-
bind_rows(
abacus_tfb %>% mutate(Cultivar = "abacus"),
SL2_tfb %>% mutate(Cultivar = "SL2"),
finola_tfb %>% mutate(Cultivar = "finola"),
PK_tfb %>% mutate(Cultivar = "PKush"),
JLdash_tfb %>% mutate(Cultivar = "JLdash"),
JL5_tfb %>% mutate(Cultivar = "JL5"),
Pbanana_tfb %>% mutate(Cultivar = "Pbanana")) %>%
distinct(Cultivar, V1) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Cultivar, values_from = value, values_fill = 0) %>%
pivot_longer(-V1, names_to = "Cultivar", values_to = "Present") %>%
add_column(WholeGene = 1)
View(plus_tfb_presence_matrix)
library(tidyverse)
library(ggplot2)
setwd("C:/Users/scej4/OneDrive/Desktop/diplomska_koda/cbdasB_plantRegMap")
library(ComplexUpset)
library(UpSetR)
library(dplyr)
library(tidyr)
plus_prom_presence_matrix <- bind_rows(
abacus %>% mutate(Plant = "abacus"),
SL2 %>% mutate(Plant = "SL2"),
finola %>% mutate(Plant = "finola"),
PKush %>% mutate(Plant = "PKush"),
JLdash %>% mutate(Plant = "JLdash"),
Pbanana %>% mutate(Plant = "Pbanana")) %>%
distinct(Plant, V1) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Plant, values_from = value, values_fill = 0) %>%
pivot_longer(-V1, names_to = "Plant", values_to = "Present") %>%
add_column(WholeGene = 0)
abacus_prom <- plus_strand('abacus_cbadsPromB_plantRegMap.txt')
setwd("C:/Users/scej4/OneDrive/Desktop/diplomska_koda/cbdasB_plantRegMap")
abacus_prom <- plus_strand('abacus_cbadsPromB_plantRegMap.txt')
finola_prom <- plus_strand('finola_cbdasPromB_rpm.txt')
JL5_prom <- plus_strand('JL5_cbdasPromB_prm.txt')
JLdash_prom <- plus_strand('JLdash_cbdasPromB_prm.txt')
Pbanana_prom <- plus_strand('Pbanana_cbdasPromB_prm.txt')
PKush_prom <- plus_strand('PK_cbdasPromB_prm.txt')
SL2_prom <- plus_strand('SL2_cbdasPromB_prm.txt')
anc1_prom <- minus_strand('anc1_cbdasPromB_prm.txt')
anc2_prom <- minus_strand('anc2_cbdasPromB_prm.txt')
cannatonic_prom <- minus_strand('cannatonic_cbdasPromB_prm.txt')
cannbio_prom <- minus_strand('cannbio_cbdasPromB_prm.txt')
CP_prom <- minus_strand('CP_cbdasPromB_rpm.txt')
hOG1_prom <- minus_strand('hOG1_cbdasPromB_prm.txt')
hOG2_prom <- minus_strand('hOG2_cbdasPromB_rpm.txt')
JL_prom <- minus_strand('JL_cbdasPromB_prm.txt')
JLfather_prom <- minus_strand('JLfather_cbdasPromB_prm.txt')
JLmother_prom <- minus_strand('JLmother_cbdasPromB_prm.txt')
PR_prom <- minus_strand('PR_cbdasPromB_prm.txt')
SL1_prom <- minus_strand('SL1_cbdasPromB_prm.txt')
travisCBD1_prom <- minus_strand('travisCBD1_cbdasPromB_prm.txt')
travisCBD2_prom <- minus_strand('travisCBD2_cbdasPromB_prm.txt')
Ppepper_prom <- minus_strand('Ppepper_cbdasPromB_prm.txt')
plus_prom_presence_matrix <- bind_rows(
abacus %>% mutate(Plant = "abacus"),
SL2 %>% mutate(Plant = "SL2"),
finola %>% mutate(Plant = "finola"),
PKush %>% mutate(Plant = "PKush"),
JLdash %>% mutate(Plant = "JLdash"),
Pbanana %>% mutate(Plant = "Pbanana")) %>%
distinct(Plant, V1) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Plant, values_from = value, values_fill = 0) %>%
pivot_longer(-V1, names_to = "Plant", values_to = "Present") %>%
add_column(WholeGene = 0)
plus_prom_presence_matrix <- bind_rows(
abacus_prom %>% mutate(Plant = "abacus"),
SL2_prom %>% mutate(Plant = "SL2"),
finola_prom %>% mutate(Plant = "finola"),
PKush_prom %>% mutate(Plant = "PKush"),
JLdash_prom %>% mutate(Plant = "JLdash"),
Pbanana_prom %>% mutate(Plant = "Pbanana")) %>%
distinct(Plant, V1) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Plant, values_from = value, values_fill = 0) %>%
pivot_longer(-V1, names_to = "Plant", values_to = "Present") %>%
add_column(WholeGene = 0)
View(plus_prom_presence_matrix)
plus_prom_presence_matrix <- bind_rows(
abacus_prom %>% mutate(Cultivar = "abacus"),
SL2_prom %>% mutate(Cultivar = "SL2"),
finola_prom %>% mutate(Cultivar = "finola"),
PKush_prom %>% mutate(Cultivar = "PKush"),
JLdash_prom %>% mutate(Cultivar = "JLdash"),
Pbanana_prom %>% mutate(Cultivar = "Pbanana")) %>%
distinct(Plant, V1) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Plant, values_from = value, values_fill = 0) %>%
pivot_longer(-V1, names_to = "Plant", values_to = "Present") %>%
add_column(WholeGene = 0)
View(plus_prom_presence_matrix)
plus_prom_presence_matrix <- bind_rows(
abacus_prom %>% mutate(Cultivar = "abacus"),
SL2_prom %>% mutate(Cultivar = "SL2"),
finola_prom %>% mutate(Cultivar = "finola"),
PKush_prom %>% mutate(Cultivar = "PKush"),
JLdash_prom %>% mutate(Cultivar = "JLdash"),
Pbanana_prom %>% mutate(Cultivar = "Pbanana")) %>%
distinct(Plant, V1) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Cultivar, values_from = value, values_fill = 0) %>%
pivot_longer(-V1, names_to = "Cultivar", values_to = "Present") %>%
add_column(WholeGene = 0)
plus_prom_presence_matrix <- bind_rows(
abacus_prom %>% mutate(Cultivar = "abacus"),
SL2_prom %>% mutate(Cultivar = "SL2"),
finola_prom %>% mutate(Cultivar = "finola"),
PKush_prom %>% mutate(Cultivar = "PKush"),
JLdash_prom %>% mutate(Cultivar = "JLdash"),
Pbanana_prom %>% mutate(Cultivar = "Pbanana")) %>%
distinct(Cultivar, V1) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Cultivar, values_from = value, values_fill = 0) %>%
pivot_longer(-V1, names_to = "Cultivar", values_to = "Present") %>%
add_column(WholeGene = 0)
View(plus_prom_presence_matrix)
union(plus_prom_presence_matrix, plus_tfb_presence_matrix )
union(plus_prom_presence_matrix, plus_tfb_presence_matrix) %>%  head()

trees %>%
group_by(Size) %>%
summarise(stevilo = n())
trees %>%
group_by(Size) %>%
summarise(stevilo = n()) %>%
ggplot(aes(Size, stevilo)) +
geom_col()
foo <- function(x, y) {
if (x == 0) {
return(y)
} else {
y <- 2 * y + x %% 2
return(foo(x / 2, y))
}
}
result <- foo(5, 0)
print(result)
is.infinite(result)
library(adegenet)
# Isto kot na prejšnjih vajah zaženite ukaze, da naložite potrebne pakete (adegenet in dartR)
library(dartR)
install.packages("cli")
install.packages("cli")
install.packages("cli")
# Isto kot na prejšnjih vajah zaženite ukaze, da naložite potrebne pakete (adegenet in dartR)
library(dartR)
getwd()
load("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/2_exercises_R/funk_genomika.RData")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/slike_za_seminar/EP_za_sample.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/2_exercises_R/grafi/vsd.png")
knitr::include_graphics("C:\Users\scej4\OneDrive\Desktop\UNI_3B\Funk_genomika\2_exercises_R\grafi\MDS.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/2_exercises_R/grafi/MDS.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/3_exercises_R/grafi3/heat_map.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/slike_za_seminar/000010.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/slike_za_seminar/000012.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/slike_za_seminar/000016.png")
res2 <- results(dds, name = "cell.line.ch1_HMEC.1_vs_EA.hy926")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/heatMap_4Vaje.png")
View(res)
View(res.df.ordered)
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/slike_za_seminar/5_genes_log2FC.png")
setwd("C:/Users/scej4/OneDrive/Desktop/diplomska_koda/cbdasB_plantRegMap")
library(tidyverse)
plus_strand <- function(x) {
read.table(file = x, sep = "\t") |>
filter(V6 == '+')
}
minus_strand <- function(x) {
read.table(file = x, sep = "\t") |>
filter(V6 == '-')
}
#Uporabljeni fasta files SAMO s promotorsko regijo (2000bp pred genom)
#Plus strand---------------------------------------------------------------------------------------------------
abacus <- plus_strand('abacus_cbadsPromB_plantRegMap.txt')
finola <- plus_strand('finola_cbdasPromB_rpm.txt')
JL5 <- plus_strand('JL5_cbdasPromB_prm.txt')
JLdash <- plus_strand('JLdash_cbdasPromB_prm.txt')
Pbanana <- plus_strand('Pbanana_cbdasPromB_prm.txt')
PKush <- plus_strand('PK_cbdasPromB_prm.txt')
SL2 <- plus_strand('SL2_cbdasPromB_prm.txt')
#Minus strand--------------------------------------------------------------------------------------------------
anc1 <- minus_strand('anc1_cbdasPromB_prm.txt')
anc2 <- minus_strand('anc2_cbdasPromB_prm.txt')
cannatonic <- minus_strand('cannatonic_cbdasPromB_prm.txt')
cannbio <- minus_strand('cannbio_cbdasPromB_prm.txt')
CP <- minus_strand('CP_cbdasPromB_rpm.txt')
hOG1 <- minus_strand('hOG1_cbdasPromB_prm.txt')
hOG2 <- minus_strand('hOG2_cbdasPromB_rpm.txt')
JL <- minus_strand('JL_cbdasPromB_prm.txt')
JLfather <- minus_strand('JLfather_cbdasPromB_prm.txt')
JLmother <- minus_strand('JLmother_cbdasPromB_prm.txt')
PR <- minus_strand('PR_cbdasPromB_prm.txt')
SL1 <- minus_strand('SL1_cbdasPromB_prm.txt')
travisCBD1 <- minus_strand('travisCBD1_cbdasPromB_prm.txt')
travisCBD2 <- minus_strand('travisCBD2_cbdasPromB_prm.txt')
Ppepper <- minus_strand('Ppepper_cbdasPromB_prm.txt')
#PLOT----------------------------------------------------------------------------------------------------------
library(tidyverse)
library(ggplot2)
setwd("C:/Users/scej4/OneDrive/Desktop/diplomska_koda/cbdasB_plantRegMap")
library(ComplexUpset)
library(UpSetR)
motif_list <- list(
abacusM = abacus$V1,
anc1M = anc1$V1,
anc2M = anc2$V1,
cannatonicM = cannatonic$V1,
cannbioM = cannbio$V1,
CPM = CP$V1,
finolaM = finola$V1,
hOG1M = hOG1$V1,
hOG2M = hOG2$V1,
JLM = JL$V1,
JL5M = JL5$V1,
JLdashM = JLdash$V1,
JLmotherM = JLmother$V1,
JLfatherM = JLfather$V1,
PbananaM = Pbanana$V1,
PKushM = PKush$V1,
PpepperM = Ppepper$V1,
PRM = PR$V1,
SL1M = SL1$V1,
SL2M = SL2$V1,
travisCBD1M = travisCBD1$V1,
travisCBD2M = travisCBD2$V1
)
motif_minus_list <- list(
anc1M = anc1$V1,
anc2M = anc2$V1,
cannatonicM = cannatonic$V1,
cannbioM = cannbio$V1,
CPM = CP$V1,
hOG1M = hOG1$V1,
hOG2M = hOG2$V1,
JLM = JL$V1,
JLmotherM = JLmother$V1,
JLfatherM = JLfather$V1,
PpepperM = Ppepper$V1,
PRM = PR$V1,
SL1M = SL1$V1,
travisCBD1M = travisCBD1$V1,
travisCBD2M = travisCBD2$V1
)
motif_plus_list <- list(
abacusM = abacus$V1,
SL2M = SL2$V1,
finolaM = finola$V1,
PKushM = PKush$V1,
JLdashM = JLdash$V1,
JL5M = JL5$V1,
PbananaM = Pbanana$V1
)
library(dplyr)
library(tidyr)
combined_minus <- bind_rows(
anc1 %>% mutate(Plant = "anc1"),
anc2 %>% mutate(Plant = "anc2"),
cannatonic %>% mutate(Plant = "cannatonic"),
cannbio %>% mutate(Plant = "cannbio"),
CP %>% mutate(Plant = "CP"),
hOG1 %>% mutate(Plant = "hOG1"),
hOG2 %>% mutate(Plant = "hOG2"),
JL %>% mutate(Plant = "JL"),
Ppepper %>% mutate(Plant = "Ppepper"),
PR %>% mutate(Plant = "PR"),
SL1 %>% mutate(Plant = "SL1"),
travisCBD1 %>% mutate(Plant = "travisCBD1"),
travisCBD2 %>% mutate(Plant = "travisCBD2"),
)
View(combined_minus)
minus_presence_matrix <- combined_minus %>%
distinct(Plant, V1) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Plant, values_from = value, values_fill = 0)
View(minus_presence_matrix)
minus_presence_matrix <- combined_minus %>%
distinct(Plant, V1) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Plant, values_from = value, values_fill = 0) %>%
pivot_longer(-V1, names_to = "Plant", values_to = "Present")
View(minus_presence_matrix)
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
theme(axis.text.y = element_blank()) +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants")
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
theme(axis.text.y = V1) +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants")
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
theme(axis.text.y = element_blank()) +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants")
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants")
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
text.scale = 0.6 +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants")
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants")
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 5))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 3))
combined_minus <- bind_rows(
anc1 %>% mutate(Plant = "anc1"),
anc2 %>% mutate(Plant = "anc2"),
cannatonic %>% mutate(Plant = "cannatonic"),
cannbio %>% mutate(Plant = "cannbio"),
CP %>% mutate(Plant = "CP"),
hOG1 %>% mutate(Plant = "hOG1"),
hOG2 %>% mutate(Plant = "hOG2"),
JL %>% mutate(Plant = "JL"),
Ppepper %>% mutate(Plant = "Ppepper"),
PR %>% mutate(Plant = "PR"),
SL1 %>% mutate(Plant = "SL1"),
travisCBD1 %>% mutate(Plant = "t1"),
travisCBD2 %>% mutate(Plant = "t2"),
)
minus_presence_matrix <- combined_minus %>%
distinct(Plant, V1) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Plant, values_from = value, values_fill = 0) %>%
pivot_longer(-V1, names_to = "Plant", values_to = "Present")
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 3))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 2.5))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 3))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, lineheight = 1.5))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, lineheight = 2))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, lineheight = 5))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, lineheight = 10))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, lineheight = 100))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 4, lineheight = 100))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, lineheight = 100))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, lineheight = 1000))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, lineheight = 1000)) +
coord_fixed(ratio = 0.5)
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, lineheight = 1000)) +
coord_fixed(ratio = 1)
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(xis.text.y = element_text(size = 6, lineheight = 1.3),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, lineheight = 1.3),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 1.3),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 5),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 100000000),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 0.5),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 3, angle = 45, lineheight = 0.5),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 0.5),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 2.5),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 0.5),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 0.15),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 15),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, angle = 45),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
n_rows <- length(unique(minus_presence_matrix$V1))
n_rows_minus <- length(unique(minus_presence_matrix$V1))
height_minus <- max(6, n_rows * 0.15)
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present", title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, angle = 45),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
heatmap_minus <-
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present",
title = "Predicted TF binding sites presence across Cannabis plants") +
theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 1.2),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggsave("heatmap_minus2.png", plot = heatmap_minus, width = 8, height = height_minus, dpi = 300)
heatmap_minus <-
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present",
title = "Predicted TF binding sites presence across different Cannabis S. cultivars - minus strand") +
theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 1.2),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggsave("heatmap_minus2.png", plot = heatmap_minus, width = 8, height = height_minus, dpi = 300)
heatmap_minus <-
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present",
title = "Predicted TF binding sites presence across different Cannabis S. cultivars - minus strand") +
theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 1.2),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggsave("heatmap_minus2.png", plot = heatmap_minus, width = 8, height = height_minus, dpi = 300, bg = "white")
heatmap_minus <-
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present",
y = "Motif"
title = "Predicted TF binding sites presence across different Cannabis S. cultivars - minus strand") +
heatmap_minus <-
ggplot(minus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present",
title = "Predicted TF binding sites presence across different Cannabis S. cultivars - minus strand") +
theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 1.2),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggsave("heatmap_minus2.png", plot = heatmap_minus, width = 8, height = height_minus, dpi = 300, bg = "white")
upset(fromList(motif_minus_list),
nsets = 15,
order.by = "freq",
text.scale = 0.6)
motif_plus_list <- list(
abacusP = abacus$V1,
SL2P = SL2$V1,
finolaP = finola$V1,
PKushP = PKush$V1,
JLdashP = JLdash$V1,
JL5P = JL5$V1,
PbananaP = Pbanana$V1
)
combined_plus <- bind_rows(
abacus %>% mutate(Plant = "abacus"),
SL2 %>% mutate(Plant = "SL2"),
finola %>% mutate(Plant = "finola"),
Pkush %>% mutate(Plant = "Pkush"),
JLdash %>% mutate(Plant = "JLdash"),
Pbanana %>% mutate(Plant = "Pbanana"),
)
combined_plus <- bind_rows(
abacus %>% mutate(Plant = "abacus"),
SL2 %>% mutate(Plant = "SL2"),
finola %>% mutate(Plant = "finola"),
PKush %>% mutate(Plant = "PKush"),
JLdash %>% mutate(Plant = "JLdash"),
Pbanana %>% mutate(Plant = "Pbanana"),
)
plus_presence_matrix <- combined_plus %>%
distinct(Plant, V1) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Plant, values_from = value, values_fill = 0) %>%
pivot_longer(-V1, names_to = "Plant", values_to = "Present")
n_rows_plus <- length(unique(plus_presence_matrix$V1))
height_plus <- max(6, n_rows_plus * 0.15)
View(plus_presence_matrix)
n_rows_plus <- length(unique(plus_presence_matrix$V1))
height_plus <- max(6, n_rows_plus * 0.15)
heatmap_plus <-
ggplot(plus_presence_matrix, aes(x = Plant, y = V1, fill = factor(Present))) +
geom_tile(color = "white") +
scale_fill_manual(values = c("0" = "white", "1" = "darkgreen")) +
theme_minimal() +
labs(fill = "Present",
title = "Predicted TF binding sites presence across different Cannabis S. cultivars - plus strand") +
theme(axis.text.y = element_text(size = 6, angle = 45, lineheight = 1.2),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
ggsave("heatmap_plus.png", plot = heatmap_plus, width = 8, height = height_minus, dpi = 300, bg = "white")

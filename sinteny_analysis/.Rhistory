# Isto kot na prejšnjih vajah zaženite ukaze, da naložite potrebne pakete (adegenet in dartR)
library(dartR)
getwd()
load("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/2_exercises_R/funk_genomika.RData")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/slike_za_seminar/EP_za_sample.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/2_exercises_R/grafi/vsd.png")
knitr::include_graphics("C:\Users\scej4\OneDrive\Desktop\UNI_3B\Funk_genomika\2_exercises_R\grafi\MDS.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/2_exercises_R/grafi/MDS.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/3_exercises_R/grafi3/heat_map.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/slike_za_seminar/000010.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/slike_za_seminar/000012.png")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/slike_za_seminar/000016.png")
res2 <- results(dds, name = "cell.line.ch1_HMEC.1_vs_EA.hy926")
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/heatMap_4Vaje.png")
View(res)
View(res.df.ordered)
knitr::include_graphics("C:/Users/scej4/OneDrive/Desktop/UNI_3B/Funk_genomika/slike_za_seminar/5_genes_log2FC.png")
setwd("C:/Users/scej4/OneDrive/Desktop/diplomska_koda/promB_only/TF_binding_sites_promB")
library(tidyverse)
plus_strand <- function(x) {
read.table(file = x, sep = "\t") |>
filter(V6 == '+')
}
minus_strand <- function(x) {
read.table(file = x, sep = "\t") |>
filter(V6 == '-')
}
abacus_promB <- plus_strand('abacus_promB_tfb.txt')
finola_promB <- plus_strand('finola_promB_tfb.txt')
JL5_promB <- plus_strand('JL5_promB_tfb.txt')
JLdash_promB <- plus_strand('JLdash_promB_tfb.txt')
Pbanana_promB <- plus_strand('Pbanana_promB_tfb.txt')
PK_promB <- plus_strand('PK_promB_tfb.txt')
SL2_promB <- plus_strand('SL2_promB_tfb.txt')
anc1_promB <- plus_strand('anc1_promB_tfb.txt')
anc2_promB <- plus_strand('anc2_promB_tfb.txt')
cannatonic_promB <- plus_strand('cannatonic_promB_tfb.txt')
cannbio_promB <- plus_strand('cannbio_promB_tfb.txt')
CP_promB <- plus_strand('CP_promB_tfb.txt')
hOG1_promB <- plus_strand('hOG1_promB_tfb.txt')
hOG2_promB <- plus_strand('hOG2_promB_tfb.txt')
JLfather_promB <- plus_strand('JLfather_promB_tfb.txt')
JLmother_promB <- plus_strand('JLmother_promB_tfb.txt')
PR_promB <- plus_strand('PR_promB_tfb.txt')
SL1_promB <- plus_strand('SL1_promB_tfb.txt')
travis1_promB <- plus_strand('travis1_promB_tfb.txt')
travis2_promB <- plus_strand('travis2_promB_tfb.txt')
pPepper_promB <- plus_strand('pPepper_promB_tfb.txt')
plus_promB_presence_matrix <-
bind_rows(
abacus_promB  %>% mutate(Cultivar = "abacus"),
finola_promB %>% mutate(Cultivar = "finola"),
JL5_promB %>% mutate(Cultivar = "JL5"),
JLdash_promB %>% mutate(Cultivar = "JLdash"),
Pbanana_promB %>% mutate(Cultivar = "Pbanana"),
PK_promB %>% mutate(Cultivar = "PK"),
SL2_promB %>% mutate(Cultivar = "SL2"),
anc1_promB %>% mutate(Cultivar = "anc1"),
anc2_promB %>% mutate(Cultivar = "anc2"),
cannatonic_promB %>% mutate(Cultivar = "cannatonic"),
cannbio_promB %>% mutate(Cultivar = "cannbio"),
CP_promB %>% mutate(Cultivar = "CP"),
hOG1_promB %>% mutate(Cultivar = "hOG1"),
hOG2_promB %>% mutate(Cultivar = "hOG2"),
JLfather_promB %>% mutate(Cultivar = "JLfather"),
JLmother_promB %>% mutate(Cultivar = "JLmother"),
PR_promB %>% mutate(Cultivar = "PR"),
SL1_promB %>% mutate(Cultivar = "SL1"),
travis1_promB %>% mutate(Cultivar = "travis1"),
travis2_promB %>% mutate(Cultivar = "travis2"),
pPepper_promB %>% mutate(Cultivar = "pPepper")
) %>%
distinct(Cultivar, V1, V2) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Cultivar, values_from = value, values_fill = 0) %>%
pivot_longer(cols = anc1:pPepper, names_to = "Cultivar", values_to = "Presence")
View(plus_promB_presence_matrix)
plus_promB_presence_matrix <-
bind_rows(
abacus_promB  %>% mutate(Cultivar = "abacus"),
finola_promB %>% mutate(Cultivar = "finola"),
JL5_promB %>% mutate(Cultivar = "JL5"),
JLdash_promB %>% mutate(Cultivar = "JLdash"),
Pbanana_promB %>% mutate(Cultivar = "Pbanana"),
PK_promB %>% mutate(Cultivar = "PK"),
SL2_promB %>% mutate(Cultivar = "SL2"),
anc1_promB %>% mutate(Cultivar = "anc1"),
anc2_promB %>% mutate(Cultivar = "anc2"),
cannatonic_promB %>% mutate(Cultivar = "cannatonic"),
cannbio_promB %>% mutate(Cultivar = "cannbio"),
CP_promB %>% mutate(Cultivar = "CP"),
hOG1_promB %>% mutate(Cultivar = "hOG1"),
hOG2_promB %>% mutate(Cultivar = "hOG2"),
JLfather_promB %>% mutate(Cultivar = "JLfather"),
JLmother_promB %>% mutate(Cultivar = "JLmother"),
PR_promB %>% mutate(Cultivar = "PR"),
SL1_promB %>% mutate(Cultivar = "SL1"),
travis1_promB %>% mutate(Cultivar = "travis1"),
travis2_promB %>% mutate(Cultivar = "travis2"),
pPepper_promB %>% mutate(Cultivar = "pPepper")
) %>%
distinct(Cultivar, V1, V2) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Cultivar, values_from = value, values_fill = 0) %>%
pivot_longer(cols = abacus:pPepper, names_to = "Cultivar", values_to = "Presence")
View(plus_promB_presence_matrix)
View(plus_promB_presence_matrix)
plus_families_count_promB <- plus_promB_presence_matrix %>% group_by(.$V2) %>% count(.)
View(plus_families_count_promB)
(
ggplot(plus_promB_presence_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_viridis_d(option = "turbo") +
scale_alpha_manual(values = c("0" = 0, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(angle = 45, size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Motif",
fill = "Family",
alpha = "Presence",
title = "Predicted TFB sites & families presence across different Cannabis S. cultivars (cbdas promotor region) - plus strand"
)
) %>% ggsave("heatmap_plus_tfb_family_promB.png", plot = ., width = 10,
height = max(6, length(unique(minus_tfb_family_matrix$V1)) * 0.15),
dpi = 300, bg = "white")
(
ggplot(plus_promB_presence_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_viridis_d(option = "turbo") +
scale_alpha_manual(values = c("0" = 0, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(angle = 45, size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Motif",
fill = "Family",
alpha = "Presence",
title = "Predicted TFB sites & families presence across different Cannabis S. cultivars (cbdas promotor region) - plus strand"
)
) %>% ggsave("heatmap_plus_tfb_family_promB.png", plot = ., width = 10,
height = max(6, length(unique(plus_promB_presence_matrix$V1)) * 0.15),
dpi = 300, bg = "white")
plus_promB_presence_matrix <-
bind_rows(
abacus_promB  %>% mutate(Cultivar = "abacus"),
finola_promB %>% mutate(Cultivar = "finola"),
JL5_promB %>% mutate(Cultivar = "JL5"),
JLdash_promB %>% mutate(Cultivar = "JLdash"),
Pbanana_promB %>% mutate(Cultivar = "Pbanana"),
PK_promB %>% mutate(Cultivar = "PK"),
anc1_promB %>% mutate(Cultivar = "anc1"),
anc2_promB %>% mutate(Cultivar = "anc2"),
cannatonic_promB %>% mutate(Cultivar = "cannatonic"),
cannbio_promB %>% mutate(Cultivar = "cannbio"),
CP_promB %>% mutate(Cultivar = "CP"),
hOG1_promB %>% mutate(Cultivar = "hOG1"),
hOG2_promB %>% mutate(Cultivar = "hOG2"),
JLfather_promB %>% mutate(Cultivar = "JLfather"),
JLmother_promB %>% mutate(Cultivar = "JLmother"),
PR_promB %>% mutate(Cultivar = "PR"),
SL1_promB %>% mutate(Cultivar = "SL1"),
travis1_promB %>% mutate(Cultivar = "travis1"),
travis2_promB %>% mutate(Cultivar = "travis2"),
pPepper_promB %>% mutate(Cultivar = "pPepper")
) %>%
distinct(Cultivar, V1, V2) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Cultivar, values_from = value, values_fill = 0) %>%
pivot_longer(cols = abacus:pPepper, names_to = "Cultivar", values_to = "Presence")
plus_families_count_promB <- plus_promB_presence_matrix %>% group_by(.$V2) %>% count(.)
(
ggplot(plus_promB_presence_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_viridis_d(option = "turbo") +
scale_alpha_manual(values = c("0" = 0, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(angle = 45, size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Motif",
fill = "Family",
alpha = "Presence",
title = "Predicted TFB sites & families presence across different Cannabis S. cultivars (cbdas promotor region) - plus strand"
)
) %>% ggsave("heatmap_plus_tfb_family_promB.png", plot = ., width = 10,
height = max(6, length(unique(plus_promB_presence_matrix$V1)) * 0.15),
dpi = 300, bg = "white")
abacus_promB <- minus_strand('abacus_promB_tfb.txt')
finola_promB <- minus_strand('finola_promB_tfb.txt')
JL5_promB <- minus_strand('JL5_promB_tfb.txt')
JLdash_promB <- minus_strand('JLdash_promB_tfb.txt')
Pbanana_promB <- minus_strand('Pbanana_promB_tfb.txt')
PK_promB <- minus_strand('PK_promB_tfb.txt')
SL2_promB <- minus_strand('SL2_promB_tfb.txt')
anc1_promB <- minus_strand('anc1_promB_tfb.txt')
anc2_promB <- minus_strand('anc2_promB_tfb.txt')
cannatonic_promB <- minus_strand('cannatonic_promB_tfb.txt')
cannbio_promB <- minus_strand('cannbio_promB_tfb.txt')
CP_promB <- minus_strand('CP_promB_tfb.txt')
hOG1_promB <- minus_strand('hOG1_promB_tfb.txt')
hOG2_promB <- minus_strand('hOG2_promB_tfb.txt')
JLfather_promB <- minus_strand('JLfather_promB_tfb.txt')
JLmother_promB <- minus_strand('JLmother_promB_tfb.txt')
PR_promB <- minus_strand('PR_promB_tfb.txt')
SL1_promB <- minus_strand('SL1_promB_tfb.txt')
travis1_promB <- minus_strand('travis1_promB_tfb.txt')
travis2_promB <- minus_strand('travis2_promB_tfb.txt')
pPepper_promB <- minus_strand('pPepper_promB_tfb.txt')
View(abacus_promB)
View(anc1_promB)
minus_promB_presence_matrix <-
bind_rows(
abacus_promB  %>% mutate(Cultivar = "abacus"),
finola_promB %>% mutate(Cultivar = "finola"),
JL5_promB %>% mutate(Cultivar = "JL5"),
JLdash_promB %>% mutate(Cultivar = "JLdash"),
Pbanana_promB %>% mutate(Cultivar = "Pbanana"),
PK_promB %>% mutate(Cultivar = "PK"),
anc1_promB %>% mutate(Cultivar = "anc1"),
anc2_promB %>% mutate(Cultivar = "anc2"),
cannatonic_promB %>% mutate(Cultivar = "cannatonic"),
cannbio_promB %>% mutate(Cultivar = "cannbio"),
CP_promB %>% mutate(Cultivar = "CP"),
hOG1_promB %>% mutate(Cultivar = "hOG1"),
hOG2_promB %>% mutate(Cultivar = "hOG2"),
JLfather_promB %>% mutate(Cultivar = "JLfather"),
JLmother_promB %>% mutate(Cultivar = "JLmother"),
PR_promB %>% mutate(Cultivar = "PR"),
SL1_promB %>% mutate(Cultivar = "SL1"),
travis1_promB %>% mutate(Cultivar = "travis1"),
travis2_promB %>% mutate(Cultivar = "travis2"),
pPepper_promB %>% mutate(Cultivar = "pPepper")
) %>%
distinct(Cultivar, V1, V2) %>%
mutate(value = 1) %>%
pivot_wider(names_from = Cultivar, values_from = value, values_fill = 0) %>%
pivot_longer(cols = abacus:pPepper, names_to = "Cultivar", values_to = "Presence")
View(minus_promB_presence_matrix)
minus_families_count_promB <- minus_promB_presence_matrix %>% group_by(.$V2) %>% count(.)
View(minus_families_count_promB)
(
ggplot(minus_promB_presence_matrix,
aes(x = Cultivar, y = V1, fill = V2, alpha = factor(Presence))) +
geom_tile(color = "white") +
scale_fill_viridis_d(option = "turbo") +
scale_alpha_manual(values = c("0" = 0, "1" = 1)) +
theme_minimal(base_size = 10) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(angle = 45, size = 6),
panel.grid = element_blank()
) +
labs(
x = "Cultivar",
y = "Motif",
fill = "Family",
alpha = "Presence",
title = "Predicted TFB sites & families presence across different Cannabis S. cultivars (cbdas promotor region) - minus strand"
)
) %>% ggsave("heatmap_minus_tfb_family_promB.png", plot = ., width = 10,
height = max(6, length(unique(plus_promB_presence_matrix$V1)) * 0.15),
dpi = 300, bg = "white")
View(minus_families_count_promB)
View(abacus_promB)
setwd("C:/Users/scej4/OneDrive/Desktop/diplomska_koda/sinteny_analysis")
library(tidyverse)
getwd()
abacus <- read_tsv('abacus_promB_tfb.txt') %>% mutate(Cultivar = "abacus")
View(abacus)
all_cultivars <- bind_rows(
read_tsv('abacus_promB_tfb.txt') %>% mutate(Cultivar = "abacus"),
read_tsv('finola_promB_tfb.txt') %>% mutate(Cultivar = "finola")
)
View(all_cultivars)
all_cultivars <- bind_rows(
read_tsv('abacus_promB_tfb.txt') %>% mutate(Cultivar = "abacus"),
read_tsv('finola_promB_tfb.txt') %>% mutate(Cultivar = "finola"),
read_tsv('finola_promB_tfb.txt') %>% mutate(Cultivar = "finola"),
read_tsv('finola_promB_tfb.txt') %>% mutate(Cultivar = "finola"),
read_tsv('finola_promB_tfb.txt') %>% mutate(Cultivar = "finola"),
read_tsv('finola_promB_tfb.txt') %>% mutate(Cultivar = "finola"),
read_tsv('finola_promB_tfb.txt') %>% mutate(Cultivar = "finola"),
read_tsv('finola_promB_tfb.txt') %>% mutate(Cultivar = "finola"),
read_tsv('finola_promB_tfb.txt') %>% mutate(Cultivar = "finola"),
read_tsv('finola_promB_tfb.txt') %>% mutate(Cultivar = "finola"),
read_tsv('finola_promB_tfb.txt') %>% mutate(Cultivar = "finola"),
read_tsv('finola_promB_tfb.txt') %>% mutate(Cultivar = "finola"),
read_tsv('finola_promB_tfb.txt') %>% mutate(Cultivar = "finola"),
read_tsv('finola_promB_tfb.txt') %>% mutate(Cultivar = "finola"),
read_tsv('finola_promB_tfb.txt') %>% mutate(Cultivar = "finola"),
read_tsv('finola_promB_tfb.txt') %>% mutate(Cultivar = "finola"),
)
all_cultivars <- bind_rows(
read_tsv('abacus_promB_tfb.txt') %>% mutate(Cultivar = "abacus"),
read_tsv('finola_promB_tfb.txt') %>% mutate(Cultivar = "finola"),
read_tsv('JL5_promB_tfb.txt') %>% mutate(Cultivar = "JL5"),
read_tsv('JLdash_promB_tfb.txt') %>% mutate(Cultivar = "JLdash"),
read_tsv('Pbanana_promB_tfb.txt') %>% mutate(Cultivar = "Pbanana"),
read_tsv('PK_promB_tfb.txt') %>% mutate(Cultivar = "PK"),
read_tsv('anc1_promB_tfb.txt') %>% mutate(Cultivar = "anc1"),
read_tsv('anc2_promB_tfb.txt') %>% mutate(Cultivar = "anc2"),
read_tsv('cannatonic_promB_tfb.txt') %>% mutate(Cultivar = "cannatonic"),
read_tsv('cannbio_promB_tfb.txt') %>% mutate(Cultivar = "cannbio"),
read_tsv('CP_promB_tfb.txt') %>% mutate(Cultivar = "CP"),
read_tsv('hOG1_promB_tfb.txt') %>% mutate(Cultivar = "hOG1"),
read_tsv('hOG2_promB_tfb.txt') %>% mutate(Cultivar = "hOG2"),
read_tsv('JLfather_promB_tfb.txt') %>% mutate(Cultivar = "JLfather"),
read_tsv('JLmother_promB_tfb.txt') %>% mutate(Cultivar = "JLmother"),
read_tsv('PR_promB_tfb.txt') %>% mutate(Cultivar = "PR"),
read_tsv('SL1_promB_tfb.txt') %>% mutate(Cultivar = "SL1"),
read_tsv('travis1_promB_tfb.txt') %>% mutate(Cultivar = "travis1"),
read_tsv('travis2_promB_tfb.txt') %>% mutate(Cultivar = "travis2"),
read_tsv('pPepper_promB_tfb.txt') %>% mutate(Cultivar = "pPepper")
)
View(all_cultivars)
View(all_cultivars)
all_cultivars <- bind_rows(
read_tsv('abacus_promB_tfb.txt') %>% mutate(Cultivar = "abacus"),
read_tsv('finola_promB_tfb.txt') %>% mutate(Cultivar = "finola"),
read_tsv('JL5_promB_tfb.txt') %>% mutate(Cultivar = "JL5"),
read_tsv('JLdash_promB_tfb.txt') %>% mutate(Cultivar = "JLdash"),
read_tsv('Pbanana_promB_tfb.txt') %>% mutate(Cultivar = "Pbanana"),
read_tsv('PK_promB_tfb.txt') %>% mutate(Cultivar = "PK"),
read_tsv('anc1_promB_tfb.txt') %>% mutate(Cultivar = "anc1"),
read_tsv('anc2_promB_tfb.txt') %>% mutate(Cultivar = "anc2"),
read_tsv('cannatonic_promB_tfb.txt') %>% mutate(Cultivar = "cannatonic"),
read_tsv('cannbio_promB_tfb.txt') %>% mutate(Cultivar = "cannbio"),
read_tsv('CP_promB_tfb.txt') %>% mutate(Cultivar = "CP"),
read_tsv('hOG1_promB_tfb.txt') %>% mutate(Cultivar = "hOG1"),
read_tsv('hOG2_promB_tfb.txt') %>% mutate(Cultivar = "hOG2"),
read_tsv('JLfather_promB_tfb.txt') %>% mutate(Cultivar = "JLfather"),
read_tsv('JLmother_promB_tfb.txt') %>% mutate(Cultivar = "JLmother"),
read_tsv('PR_promB_tfb.txt') %>% mutate(Cultivar = "PR"),
read_tsv('SL1_promB_tfb.txt') %>% mutate(Cultivar = "SL1"),
read_tsv('travis1_promB_tfb.txt') %>% mutate(Cultivar = "travis1"),
read_tsv('travis2_promB_tfb.txt') %>% mutate(Cultivar = "travis2"),
read_tsv('pPepper_promB_tfb.txt') %>% mutate(Cultivar = "pPepper")
) %>% mutate(direction = ifelse(strand == "+", 1, -1))
View(all_cultivars)
library(ggplot2)
ggplot(all_cultivars,
aes(x = start, xend = stop,
y = Cultivar, yend = Cultivar,
color = Family)) +
geom_segment(
size = 5,
arrow = arrow(
length = unit(0.15, "cm"),
type = "closed",
ends = "last"
)
) +
scale_color_viridis_d(option = "turbo") +
theme_minimal(base_size = 13) +
theme(
panel.grid = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
) +
labs(
title = "Promoter TFBS Synteny Map — CBDA-synthase",
x = "Promoter Position (bp)",
y = "Cultivar",
color = "TF Family"
)
ggplot(all_cultivars,
aes(x = start, xend = stop,
y = Cultivar, yend = Cultivar,
color = Family)) +
geom_segment(
size = 5,
arrow = arrow(
length = unit(0.15, "cm"),
type = "closed",
ends = "last"
)
) +
scale_color_viridis_d(option = "turbo") +
theme_minimal(base_size = 13) +
theme(
panel.grid = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
) +
labs(
title = "Promoter TFBS Synteny Map — CBDA-synthase",
x = "Promoter Position (bp)",
y = "Cultivar",
color = "TF Family"
) %>%  ggsave("promoter_synteny_plot.png", plot = ., width = 10,
height = max(6, length(unique(all_cultivars$Family)) * 0.15),
dpi = 300, bg = "white")
ggplot(all_cultivars,
aes(x = start, xend = stop,
y = Cultivar, yend = Cultivar,
color = Family)) +
geom_segment(
size = 5,
arrow = arrow(
length = unit(0.15, "cm"),
type = "closed",
ends = "last"
)
) +
scale_color_viridis_d(option = "turbo") +
theme_minimal(base_size = 13) +
theme(
panel.grid = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
) +
labs(
title = "Promoter TFBS Synteny Map — CBDA-synthase",
x = "Promoter Position (bp)",
y = "Cultivar",
color = "TF Family"
) %>%  ggsave("cbda_promB_synteny.png",
width = 12, height = 10, dpi = 300,
bg = "white")
ggplot(all_cultivars,
aes(x = start, xend = stop,
y = Cultivar, yend = Cultivar,
color = Family)) +
geom_segment(
size = 5,
arrow = arrow(
length = unit(0.15, "cm"),
type = "closed",
ends = "last"
)
) +
scale_color_viridis_d(option = "turbo") +
theme_minimal(base_size = 13) +
theme(
panel.grid = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
) +
labs(
title = "Promoter TFBS Synteny Map — CBDA-synthase",
x = "Promoter Position (bp)",
y = "Cultivar",
color = "TF Family"
) %>%  ggsave("synteny.png",
width = 12, height = 10, dpi = 300,
bg = "white")
ggplot(all_cultivars,
aes(x = start, xend = stop,
y = Cultivar, yend = Cultivar,
color = Family)) +
geom_segment(
size = 5,
arrow = arrow(
length = unit(0.15, "cm"),
type = "closed",
ends = "last"
)
) +
scale_color_viridis_d(option = "turbo") +
theme_minimal(base_size = 13) +
theme(
panel.grid = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
) +
labs(
title = "Promoter TFBS Synteny Map — CBDA-synthase",
x = "Promoter Position (bp)",
y = "Cultivar",
color = "TF Family"
) %>%  ggsave("synteny.png", plot = .,
width = 12, height = 10, dpi = 300,
bg = "white")
(
ggplot(all_cultivars,
aes(x = start, xend = stop,
y = Cultivar, yend = Cultivar,
color = Family)) +
geom_segment(
size = 5,
arrow = arrow(
length = unit(0.15, "cm"),
type = "closed",
ends = "last"
)
) +
scale_color_viridis_d(option = "turbo") +
theme_minimal(base_size = 13) +
theme(
panel.grid = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
) +
labs(
title = "Promoter TFBS Synteny Map — CBDA-synthase",
x = "Promoter Position (bp)",
y = "Cultivar",
color = "TF Family"
)
) %>%  ggsave("synteny.png", plot = .,
width = 12, height = 10, dpi = 300,
bg = "white")
